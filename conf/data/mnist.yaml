# ./conf/data/mnist.yaml

# MNIST DATASET CONFIG: Configures FLORA DataModule for MNIST dataset using torchvision.
#
# COMPOSITION FLOW:
# 1. Inherits from datamodule.yaml (which defines train/val/test structure)
# 2. datamodule.yaml applies dataloader.yaml template to each dataloader field
# 3. This config provides MNIST-specific dataset configurations and transforms
# 4. Overrides required fields (dataset, batch_size) with MNIST-specific values
#
# INHERITANCE CHAIN: dataloader.yaml → datamodule.yaml → mnist.yaml
#
# References:
# - https://docs.pytorch.org/vision/stable/generated/torchvision.datasets.MNIST.html
# - https://docs.pytorch.org/vision/stable/transforms.html

defaults:
  - datamodule # Inherit base datamodule structure (includes dataloader templates)

_target_: src.flora.data.DataModule

# ─────────────

# TRAINING DATALOADER CONFIG
# Uses dataloader template with datamodule defaults, provides MNIST-specific dataset
train:
  dataset:
    _target_: torchvision.datasets.MNIST
    root: /tmp/torchvision-mnist
    train: true
    download: true
    transform:
      _target_: torchvision.transforms.Compose
      transforms:
        - _target_: torchvision.transforms.ToTensor
        - _target_: torchvision.transforms.Normalize
          mean: [0.1307]
          std: [0.3081]


# ─────────────

# VALIDATION DATALOADER CONFIG
# Uses optional val template from datamodule.yaml (inherits from dataloader.yaml)
val:
  dataset:
    _target_: torchvision.datasets.MNIST
    root: /tmp/torchvision-mnist
    train: false
    download: true
    transform:
      _target_: torchvision.transforms.Compose
      transforms:
        - _target_: torchvision.transforms.ToTensor
        - _target_: torchvision.transforms.Normalize
          mean: [0.1307]
          std: [0.3081]

  shuffle: false # Explicitly disable shuffling for validation
